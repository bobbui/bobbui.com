name: Sync Repository to GitLab

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Sync to GitLab
        # Action: https://github.com/marketplace/actions/sync-to-gitlab
        # Implementation source: https://github.com/kujov/gitlab-sync
        uses: keninkujovic/gitlab-sync@2.1.0
        with:
          gitlab_url: ${{ secrets.GITLAB_URL }} # e.g. https://gitlab.com/yourusername/yourrepo.git
          username: ${{ secrets.GITLAB_USERNAME }} # GitLab username
          gitlab_pat: ${{ secrets.GITLAB_PAT }} # GitLab Personal Access Token (write_repository scope)
          force_push: "false" # set to 'true' to force overwrite destination branches (use with caution)

      - name: Done
        run: echo "Sync to GitLab action completed"
